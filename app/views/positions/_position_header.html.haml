%section#section-show-position-header
  .container
    .jumbotron
      .actions.pull-right
        %small
          = user_byline @position.user
          - if can? :edit, @position
            = link_to [:edit, @position] do
              %i.fa.fa-edit
              수정
          - if can? :destroy, @position
            = link_to @position, method: :delete do
              %i.fa.fa-trash
              삭제

      %h2.text-center{ style: 'font-weight: bold; padding: 0; margin-top: 40px; margin-bottom: 50px;' }= @position.body

      - unless @position.voted?(current_user)
        .vote-box.text-center
          = link_to position_votes_path(@position, vote: { choice: :agree }), method: :post, class: 'btn btn-default' do
            = choice_icon(:agree)
            찬성
          = link_to position_votes_path(@position, vote: { choice: :disagree }), method: :post, class: 'btn btn-default' do
            = choice_icon(:disagree)
            반대
          %div{ style: 'margin-top: 10px;' }
            = link_to '잘 모르겠어요', '#', class: 'text-muted'

      - if @position.voted?(current_user)
        .result-box.text-center(style="margin-top: 50px")
          %ul.nav.nav-tabs(role="tablist")
            %li(class="#{'active' if current_user.leaders.any?}" role="presentation" style="width:50%")
              %a(href="#result-leaders" role="tab" data-toggle="tab")
                %i.fa.fa-users
                내가 지지하는 사람들
            %li(class="#{'active' if current_user.leaders.empty?}" style="width:50%")
              %a(href="#result-anonymous" role="tab" data-toggle="tab")
                %i.fa.fa-cloud
                모든 사람들
          .tab-content
            .tab-pane#result-leaders(class="#{'active' if current_user.leaders.any?}" role="tabpanel")
              .row
                - if current_user.leaders.any?
                  .col-xs-6
                    %h5
                      = choice_icon(:agree)
                      찬성
                    = user_byline(current_user) if @position.agreed?(current_user)
                    - @position.votes.agree.by_leaders_of(current_user).each do |vote|
                      = user_byline vote.user
                  .col-xs-6
                    %h5
                      = choice_icon(:disagree)
                      반대
                    = user_byline(current_user) if @position.disagreed?(current_user)
                    - @position.votes.disagree.by_leaders_of(current_user).each do |vote|
                      = user_byline vote.user
                - else
                  .col-xs-12
                    %div(style='margin-top: 20px') 아직 지지하는 사람이 없습니다.
                    %a(href="#") 지지할 사람 찾기
            .tab-pane#result-anonymous(class="#{'active' if current_user.leaders.empty?}" role="tabpanel")
              .row
                .col-xs-6
                  %h5
                    = choice_icon(:agree)
                    찬성
                  - @position.votes.agree.each do |vote|
                    = user_byline vote.user
                .col-xs-6
                  %h5
                    = choice_icon(:disagree)
                    반대
                  - @position.votes.disagree.each do |vote|
                    = user_byline vote.user


